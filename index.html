
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Blue Builder Helper ‚Äî All‚Äëin‚ÄëOne</title>

<!-- Model Viewer for 3D previews -->
<script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>

<style>
  :root{
    --bg:#081028;
    --grid:#0d2e5f;
    --grid2:#0b2142;
    --line:#67e8f9;         /* cyan lines */
    --fill-soft: rgba(103,232,249,0.08);
    --hatch: rgba(103,232,249,0.18);
    --dot: rgba(103,232,249,0.9);
    --accent:#3b82f6;       /* orb base */
    --accent2:#60a5fa;
    --text:#e9f2ff;
    --muted:#b8c8ff;
  }
  *{box-sizing:border-box}
  html, body { height:100% }
  body{
    margin:0; font:16px/1.4 Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial;
    color:var(--text); background:var(--bg); overflow:hidden;
    user-select:none;
  }

  /* Photo underlay (optional) */
  .photo-underlay{
    position:absolute; inset:0; object-fit:cover;
    opacity:.14; filter:saturate(0) contrast(1.1) brightness(.9);
    pointer-events:none; z-index:1;
  }

  /* Orb */
  .orb{
    --size: 180px;
    position:absolute; left:50%; top:58%; transform:translate(-50%,-50%);
    width:var(--size); height:var(--size); border-radius:50%;
    background:
      radial-gradient(65% 65% at 35% 30%, #ffffffaa, transparent 45%),
      radial-gradient(100% 100% at 50% 50%, var(--accent2), var(--accent));
    box-shadow: 0 10px 40px #3b82f666, inset 0 0 120px #60a5fa44;
    display:flex; align-items:center; justify-content:center;
    animation:bounce 2s ease-in-out infinite;
    z-index:8;
  }
  .orb.dock{
    animation:none;
    transition: transform .9s ease, top .9s ease, left .9s ease, width .6s ease, height .6s ease;
    top:70px; left:50%; transform:translate(-50%,0); width:120px; height:120px;
  }
  @keyframes bounce {
    0%,100% { transform:translate(-50%,-50%) }
    50% { transform:translate(-50%,-60%) }
  }
  /* Face */
  .eye{ width:38px; height:38px; background:#fff; border-radius:50%; position:absolute; overflow:hidden }
  .eye .pupil{ width:18px; height:18px; background:#000; border-radius:50%; position:absolute; top:10px; left:10px; transition: transform .05s linear }
  .eyeL{ left:44px; top:56px }
  .eyeR{ right:44px; top:56px }
  .mouth{ position:absolute; bottom:42px; left:50%; transform:translateX(-50%); width:56px; height:18px; border-radius:0 0 40px 40px/0 0 18px 18px; background:#001a4d66; border:2px solid #001a4d99; border-top:none }

  /* Greeting + main controls */
  .greet{
    position:absolute; top:calc(58% + 130px); left:50%; transform:translateX(-50%);
    color:var(--text); text-align:center; font-size:22px; opacity:0; transition:opacity .8s; z-index:7;
  }
  .greet.show{ opacity:1 }
  .controls{
    position:absolute; left:50%; top:calc(58% + 200px); transform:translateX(-50%);
    display:flex; gap:12px; flex-wrap:wrap; justify-content:center; z-index:7;
  }
  .btn{ appearance:none; cursor:pointer; border:1px solid #2a4ea0; color:#e5eeff; background:#0d1a3a; padding:10px 14px; border-radius:10px; font-weight:600 }
  .btn.primary{ background:linear-gradient(180deg,#1d4ed8,#1e40af); border-color:#1e3a8a }

  /* Panels */
  .panel{
    position:absolute; z-index:9; background:#0b1533cc; border:1px solid #1e2a4c; border-radius:12px; padding:12px; backdrop-filter: blur(6px);
  }
  .panel h3{ margin:0 0 8px 0; font-size:16px }
  .small{ font-size:12px; color:#a9bdff }
  .row{ display:flex; gap:8px; flex-wrap:wrap }
  input, select{ background:#0b1430; color:var(--text); border:1px solid #223a6b; border-radius:10px; padding:8px 10px; width:100% }
  label{ font-size:13px; color:var(--muted) }

  /* Settings panel */
  #settings{ right:14px; top:14px; width:360px; max-width:94vw; display:none }

  /* Library panel (35 items) */
  #library{ right:14px; bottom:14px; width:380px; max-width:95vw; display:none; max-height:60vh; overflow:auto }
  .lib-group{ margin-bottom:10px }
  .lib-title{ font-size:13px; color:#9bb5ff; margin:8px 0 6px 0 }
  .lib-grid{ display:grid; grid-template-columns: repeat(auto-fill, minmax(110px, 1fr)); gap:8px }
  .lib-btn{ background:#0a1430; border:1px solid #203a72; border-radius:10px; padding:8px; color:#dbe8ff; font-size:13px; cursor:pointer; text-align:center }
  .lib-btn:hover{ background:#122356; border-color:#2d55a9 }

  /* Blueprint layer */
  .blueprint{
    position:absolute; inset:0; z-index:4; display:none;
    background:
      linear-gradient(90deg,var(--grid2) 1px, transparent 1px) left top / 40px 40px repeat,
      linear-gradient(0deg ,var(--grid2) 1px, transparent 1px) left top / 40px 40px repeat,
      linear-gradient(90deg,var(--grid) 1px, transparent 1px) left top / 200px 200px repeat,
      linear-gradient(0deg ,var(--grid) 1px, transparent 1px) left top / 200px 200px repeat,
      linear-gradient(180deg, #071331, #091a3d);
  }
  svg{ width:100%; height:100% }

  /* Item styles */
  .item .shape{ stroke: var(--line); stroke-width:2; fill: var(--fill-soft) }
  .item .shape.dashed{ stroke-dasharray: 6 6; fill:none }
  .item text{ fill: var(--line); font-size:12px }
  .selected .shape{ filter: drop-shadow(0 0 8px rgba(103,232,249,.9)); stroke-width:3 }
  .fall{ opacity:0; transform:translateY(-180px); animation:fallIn .8s forwards }
  @keyframes fallIn{ to{ opacity:1; transform:translateY(0) } }

  /* Toolbar */
  #toolbar{ position:absolute; left:14px; top:14px; z-index:9; display:none; gap:8px }

  /* 3D Modal */
  #modal{
    position:fixed; inset:0; background:rgba(3,6,20,.7); display:none; align-items:center; justify-content:center; z-index:20;
  }
  #modal .box{
    width:min(900px,90vw); height:min(560px,80vh); background:#091433; border:1px solid #1d2c59; border-radius:12px; padding:8px; display:flex; flex-direction:column; gap:8px;
  }
  #modal .top{ display:flex; justify-content:space-between; align-items:center; padding:4px 8px }
  #modal .top h4{ margin:0 }
  model-viewer{ width:100%; height:100%; background:#0a1230; border-radius:8px }
</style>
</head>
<body>
  <img id="photo" class="photo-underlay" alt="" />

  <!-- ORB -->
  <div id="orb" class="orb" aria-live="polite">
    <div class="eye eyeL"><div class="pupil"></div></div>
    <div class="eye eyeR"><div class="pupil"></div></div>
    <div class="mouth"></div>
  </div>

  <!-- Greeting + primary controls -->
  <div id="greet" class="greet">Hi! I‚Äôm your builder helper.<br/>Upload your backyard and I‚Äôll sketch a plan.</div>
  <div class="controls" id="controls">
    <label class="btn">
      <input id="file" type="file" accept="image/*" hidden />
      üîå Upload Backyard Photo
    </label>
    <button id="openSettings" class="btn">Settings</button>
    <button id="openLibrary" class="btn">Item Library</button>
    <button id="generate" class="btn primary">Generate Blueprint</button>
  </div>

  <!-- Settings -->
  <div id="settings" class="panel">
    <h3>Backyard Settings</h3>
    <div class="row">
      <div style="flex:1">
        <label>Length (ft)</label>
        <input id="lenFt" type="number" min="10" max="200" value="40" />
      </div>
      <div style="flex:1">
        <label>Width (ft)</label>
        <input id="widFt" type="number" min="10" max="200" value="28" />
      </div>
    </div>
    <div class="row" style="margin-top:6px">
      <div style="flex:1">
        <label>Vibe</label>
        <select id="vibe">
          <option value="auto">Auto</option>
          <option value="zen">Zen</option>
          <option value="family">Family</option>
          <option value="entertain">Entertaining</option>
          <option value="modern">Modern</option>
        </select>
      </div>
      <div style="flex:1">
        <label>Budget</label>
        <select id="budget">
          <option value="auto">Auto</option>
          <option value="low">Low</option>
          <option value="medium" selected>Medium</option>
          <option value="high">High</option>
        </select>
      </div>
    </div>
    <div class="small" style="margin-top:8px">Tip: You can still add or move items anytime from the Item Library.</div>
  </div>

  <!-- Item Library (35 items) -->
  <div id="library" class="panel">
    <h3>Item Library</h3>
    <!-- Structural -->
    <div class="lib-group">
      <div class="lib-title">Structural</div>
      <div class="lib-grid" id="lib-struct"></div>
    </div>
    <!-- Water -->
    <div class="lib-group">
      <div class="lib-title">Water Features</div>
      <div class="lib-grid" id="lib-water"></div>
    </div>
    <!-- Gardens / Nature -->
    <div class="lib-group">
      <div class="lib-title">Gardens & Nature</div>
      <div class="lib-grid" id="lib-garden"></div>
    </div>
    <!-- Entertainment -->
    <div class="lib-group">
      <div class="lib-title">Entertainment</div>
      <div class="lib-grid" id="lib-fun"></div>
    </div>
    <!-- Paths / Surfaces -->
    <div class="lib-group">
      <div class="lib-title">Paths & Surfaces</div>
      <div class="lib-grid" id="lib-paths"></div>
    </div>
    <!-- Lighting -->
    <div class="lib-group">
      <div class="lib-title">Lighting</div>
      <div class="lib-grid" id="lib-light"></div>
    </div>
  </div>

  <!-- Blueprint SVG -->
  <div id="blueprint" class="blueprint">
    <svg id="bp" viewBox="0 0 1200 800" preserveAspectRatio="xMidYMid slice"></svg>
  </div>

  <!-- Toolbar -->
  <div id="toolbar" class="panel" style="display:none; gap:8px">
    <button id="regen" class="btn">üîÅ Regenerate</button>
    <button id="export" class="btn">‚¨áÔ∏è Export SVG</button>
    <button id="del" class="btn">üóëÔ∏è Delete Selected</button>
    <button id="previewSel" class="btn primary">üëÅÔ∏è 3D Preview</button>
  </div>

  <!-- 3D Modal -->
  <div id="modal">
    <div class="box">
      <div class="top">
        <h4 id="modalTitle">3D Preview</h4>
        <div>
          <button class="btn" id="closeModal">Close</button>
        </div>
      </div>
      <div style="flex:1; min-height:300px">
        <model-viewer id="mv" camera-controls auto-rotate ar ar-modes="webxr scene-viewer quick-look" exposure="0.9" shadow-intensity="0.2" alt="3D Preview"></model-viewer>
      </div>
    </div>
  </div>

<script>
/* ===============================
   ORB (eyes + greet + upload)
=================================*/
const orb = document.getElementById('orb');
const greet = document.getElementById('greet');
const photo = document.getElementById('photo');
const fileInput = document.getElementById('file');

setTimeout(()=>greet.classList.add('show'), 600);

document.addEventListener('mousemove',(e)=>{
  document.querySelectorAll('.eye').forEach(eye=>{
    const rect = eye.getBoundingClientRect();
    const cx = rect.left + rect.width/2;
    const cy = rect.top + rect.height/2;
    const angle = Math.atan2(e.clientY - cy, e.clientX - cx);
    const dx = Math.cos(angle)*7, dy = Math.sin(angle)*7;
    eye.querySelector('.pupil').style.transform = `translate(${dx}px, ${dy}px)`;
  });
});

fileInput.addEventListener('change', ()=>{
  const f = fileInput.files?.[0];
  if(!f) return;
  photo.src = URL.createObjectURL(f);
  greet.innerHTML = "Nice! I‚Äôll sketch ideas on a blueprint.<br/>Click <b>Generate Blueprint</b>.";
});

/* ===============================
   Panels & basic controls
=================================*/
const settings = document.getElementById('settings');
const library = document.getElementById('library');
const openSettings = document.getElementById('openSettings');
const openLibrary = document.getElementById('openLibrary');
const generateBtn = document.getElementById('generate');
const blueprint = document.getElementById('blueprint');
const bp = document.getElementById('bp');
const toolbar = document.getElementById('toolbar');

openSettings.onclick = ()=> settings.style.display = (settings.style.display==='block'?'none':'block');
openLibrary.onclick = ()=> library.style.display = (library.style.display==='block'?'none':'block');

/* ===============================
   Item catalog (35 items)
   Each: id, name, cat, drawType, defaults, model
=================================*/
const MODEL_PLACEHOLDER = "https://modelviewer.dev/shared-assets/models/Astronaut.glb"; // replace with real models later

const ITEMS = [
  // Structural
  {id:'deck', name:'Deck', cat:'struct', type:'rect', w:280,h:160, label:'DECK', model:MODEL_PLACEHOLDER},
  {id:'pergola', name:'Pergola', cat:'struct', type:'pergola', w:240,h:140, label:'PERGOLA', model:MODEL_PLACEHOLDER},
  {id:'gazebo', name:'Gazebo', cat:'struct', type:'gazebo', w:160,h:160, label:'GAZEBO', model:MODEL_PLACEHOLDER},
  {id:'shed', name:'Shed', cat:'struct', type:'rect', w:120,h:80, label:'SHED', model:MODEL_PLACEHOLDER},
  {id:'greenhouse', name:'Greenhouse', cat:'struct', type:'rect', w:140,h:90, label:'GREENHOUSE', model:MODEL_PLACEHOLDER},
  {id:'outdoor_kitchen', name:'Outdoor Kitchen', cat:'struct', type:'rect', w:160,h:80, label:'KITCHEN', model:MODEL_PLACEHOLDER},
  {id:'fence', name:'Fence', cat:'struct', type:'fence', w:400,h:20, label:'FENCE', model:MODEL_PLACEHOLDER},
  {id:'patio', name:'Patio', cat:'struct', type:'hatchRect', w:280,h:160, label:'PATIO', model:MODEL_PLACEHOLDER},

  // Water
  {id:'pool_round', name:'Pool (Round)', cat:'water', type:'ellipse', rx:120,ry:100, label:'POOL', model:MODEL_PLACEHOLDER},
  {id:'pool_rect', name:'Pool (Rect)', cat:'water', type:'roundRect', w:260,h:140, r:18, label:'POOL', model:MODEL_PLACEHOLDER},
  {id:'hot_tub', name:'Hot Tub', cat:'water', type:'ellipse', rx:50,ry:50, label:'HOT TUB', model:MODEL_PLACEHOLDER},
  {id:'pond', name:'Pond', cat:'water', type:'pond', w:240,h:150, label:'POND', model:MODEL_PLACEHOLDER},
  {id:'waterfall', name:'Waterfall / Fountain', cat:'water', type:'fountain', w:120,h:60, label:'FOUNTAIN', model:MODEL_PLACEHOLDER},

  // Gardens / Nature
  {id:'zen', name:'Zen Garden', cat:'garden', type:'zen', w:300,h:200, label:'ZEN GARDEN', model:MODEL_PLACEHOLDER},
  {id:'planter_beds', name:'Planter Beds', cat:'garden', type:'beds', w:200,h:40, label:'PLANTERS', model:MODEL_PLACEHOLDER},
  {id:'veggie', name:'Vegetable Garden', cat:'garden', type:'hatchRect', w:220,h:120, label:'VEGGIES', model:MODEL_PLACEHOLDER},
  {id:'flowers', name:'Flower Beds', cat:'garden', type:'hatchRect', w:220,h:120, label:'FLOWERS', model:MODEL_PLACEHOLDER},
  {id:'trees', name:'Trees', cat:'garden', type:'trees', count:5, label:'TREES', model:MODEL_PLACEHOLDER},
  {id:'shrubs', name:'Bushes / Shrubs', cat:'garden', type:'shrubs', count:7, label:'SHRUBS', model:MODEL_PLACEHOLDER},
  {id:'rocks', name:'Rocks / Boulders', cat:'garden', type:'rocks', count:6, label:'ROCKS', model:MODEL_PLACEHOLDER},
  {id:'turf', name:'Grass / Turf Area', cat:'garden', type:'dottedRect', w:320,h:220, label:'TURF', model:MODEL_PLACEHOLDER},
  {id:'gravel', name:'Gravel Area', cat:'garden', type:'dottedRect', w:300,h:180, label:'GRAVEL', model:MODEL_PLACEHOLDER},

  // Entertainment
  {id:'fire_pit', name:'Fire Pit', cat:'fun', type:'fire', r:36, label:'FIRE', model:MODEL_PLACEHOLDER},
  {id:'grill', name:'BBQ Grill', cat:'fun', type:'rect', w:80,h:40, label:'GRILL', model:MODEL_PLACEHOLDER},
  {id:'hammock', name:'Hammock', cat:'fun', type:'arc', w:180,h:80, label:'HAMMOCK', model:MODEL_PLACEHOLDER},
  {id:'dining', name:'Outdoor Dining Table', cat:'fun', type:'roundRect', w:160,h:80, r:10, label:'DINING', model:MODEL_PLACEHOLDER},
  {id:'lounge', name:'Lounge Furniture', cat:'fun', type:'lounge', w:200,h:120, label:'LOUNGE', model:MODEL_PLACEHOLDER},
  {id:'playset', name:'Playground / Swing', cat:'fun', type:'rect', w:200,h:140, label:'PLAYSET', model:MODEL_PLACEHOLDER},
  {id:'trampoline', name:'Trampoline', cat:'fun', type:'ellipse', rx:80,ry:80, label:'TRAMP', model:MODEL_PLACEHOLDER},

  // Paths / Surfaces
  {id:'path', name:'Pathway (Pavers)', cat:'paths', type:'path', w:260,h:20, label:'PATH', model:MODEL_PLACEHOLDER},
  {id:'stepping', name:'Stepping Stones', cat:'paths', type:'stepping', count:7, label:'STEPS', model:MODEL_PLACEHOLDER},
  {id:'paver_patio', name:'Patio Pavers', cat:'paths', type:'gridRect', w:260,h:160, label:'PAVERS', model:MODEL_PLACEHOLDER},

  // Lighting
  {id:'path_lights', name:'Path Lights', cat:'light', type:'lights', count:8, label:'LIGHTS', model:MODEL_PLACEHOLDER},
  {id:'string_lights', name:'String Lights', cat:'light', type:'string', w:300,h:100, label:'STRING', model:MODEL_PLACEHOLDER},
  {id:'spots', name:'Landscape Spotlights', cat:'light', type:'spots', count:5, label:'SPOTS', model:MODEL_PLACEHOLDER},
];

/* Populate Library buttons */
const libSlots = {
  struct: document.getElementById('lib-struct'),
  water: document.getElementById('lib-water'),
  garden: document.getElementById('lib-garden'),
  fun: document.getElementById('lib-fun'),
  paths: document.getElementById('lib-paths'),
  light: document.getElementById('lib-light'),
};
ITEMS.forEach(it=>{
  const b = document.createElement('button');
  b.className='lib-btn';
  b.textContent = it.name;
  b.onclick = ()=> addItem(it.id, 200+Math.random()*700, 200+Math.random()*400, true);
  libSlots[it.cat].appendChild(b);
});

/* ===============================
   Blueprint generation & drawing
=================================*/
const R = n => Math.random()*n;
const Ri = (a,b)=>Math.floor(a+Math.random()*(b-a+1));
const stroke = getComputedStyle(document.documentElement).getPropertyValue('--line').trim();
const fillSoft = getComputedStyle(document.documentElement).getPropertyValue('--fill-soft').trim();
const hatch = getComputedStyle(document.documentElement).getPropertyValue('--hatch').trim();
const dot = getComputedStyle(document.documentElement).getPropertyValue('--dot').trim();

let ITEMS_ON_CANVAS = []; // {id,type,x,y,rot,w,h,rx,ry,el,label,...}
let SELECTED = null;

function clearSVG(){
  while(bp.firstChild) bp.removeChild(bp.firstChild);
  ITEMS_ON_CANVAS = [];
  SELECTED = null;
}

function add(el){ bp.appendChild(el); return el; }
function elem(tag, attrs={}, cls=''){
  const e = document.createElementNS('http://www.w3.org/2000/svg', tag);
  for(const k in attrs) e.setAttribute(k, attrs[k]);
  if(cls) e.setAttribute('class', cls);
  return e;
}

function labelAt(t, x, y){
  const tx = elem('text',{x,y, 'font-size':12, fill:stroke});
  tx.textContent = t; return tx;
}

/* Bounds + house edge */
function drawBounds(L, W){
  const outer = elem('rect', {x:20,y:20,width:1160,height:760, fill:'none', stroke:stroke, 'stroke-width':2});
  add(outer).classList.add('fall');
  const house = elem('line', {x1:20,y1:110,x2:1180,y2:110, stroke:stroke, 'stroke-width':2, 'stroke-dasharray':'8 8'});
  add(house).classList.add('fall');
  add(labelAt('House', 30, 102));
  const dim = elem('text',{x:1040,y:50, fill:stroke, 'font-size':14});
  dim.textContent = `~ ${L} √ó ${W} ft`;
  add(dim);
}

/* Add a new item by ID at x,y */
function addItem(itemId, x, y, animated=false){
  const meta = ITEMS.find(i=>i.id===itemId);
  if(!meta) return;

  const g = elem('g', { 'data-id':meta.id, cursor:'move' }, 'item');
  if(animated) g.classList.add('fall');
  add(g);

  // Draw shape(s)
  let w=meta.w||0, h=meta.h||0, rx=meta.rx||0, ry=meta.ry||0;
  let mainShape = null;

  function addHatchRect(x,y,w,h){
    const r = elem('rect',{x,y,width:w,height:h, fill:fillSoft, stroke:stroke, 'stroke-width':2});
    g.appendChild(r);
    for(let i=x+8;i<x+w;i+=14){
      g.appendChild(elem('line',{x1:i,y1:y+4,x2:i,y2:y+h-4, stroke:hatch, 'stroke-width':1}));
    }
    return r;
  }

  switch(meta.type){
    case 'rect':
      mainShape = elem('rect',{x:-w/2,y:-h/2,width:w,height:h, class:'shape'}); g.appendChild(mainShape); break;
    case 'hatchRect':
      mainShape = addHatchRect(-w/2, -h/2, w, h); mainShape.classList.add('shape'); break;
    case 'gridRect': {
      mainShape = elem('rect',{x:-w/2,y:-h/2,width:w,height:h, class:'shape'}); g.appendChild(mainShape);
      // grid lines
      for(let i=-w/2+12;i<w/2;i+=24){
        g.appendChild(elem('line',{x1:i,y1:-h/2+6,x2:i,y2:h/2-6, stroke:hatch, 'stroke-width':1}));
      }
      for(let j=-h/2+12;j<h/2;j+=24){
        g.appendChild(elem('line',{x1:-w/2+6,y1:j,x2:w/2-6,y2:j, stroke:hatch, 'stroke-width':1}));
      }
      break;
    }
    case 'roundRect': {
      const r = meta.r||12;
      mainShape = elem('rect',{x:-w/2,y:-h/2,width:w,height:h, rx:r, ry:r, class:'shape'}); g.appendChild(mainShape); break;
    }
    case 'ellipse':
      rx = meta.rx; ry = meta.ry;
      mainShape = elem('ellipse',{cx:0,cy:0,rx,ry, class:'shape'}); g.appendChild(mainShape);
      // water shimmer if it's a pool/hot tub/trampoline
      if(meta.id.includes('pool') || meta.id==='hot_tub' || meta.id==='trampoline'){
        for(let i=0;i<4;i++){
          const rxi = rx - i*16, ryi = ry - i*10;
          if(rxi>0 && ryi>0){
            g.appendChild(elem('ellipse',{cx:0,cy:0,rx:rxi,ry:ryi, fill:'none', stroke:stroke, 'stroke-opacity':.45, 'stroke-dasharray':'2 10'}));
          }
        }
      }
      break;
    case 'pond': {
      // irregular blob
      w = meta.w; h = meta.h;
      const p = `M ${-w/2} 0 Q ${-w/3} ${-h/2} 0 ${-h/3} T ${w/2} 0 T 0 ${h/3} T ${-w/2} 0 Z`;
      mainShape = elem('path',{d:p, class:'shape'}); g.appendChild(mainShape);
      break;
    }
    case 'fountain': {
      mainShape = elem('rect',{x:-meta.w/2,y:-meta.h/2,width:meta.w,height:meta.h, rx:20, ry:20, class:'shape dashed'}); g.appendChild(mainShape);
      const spray = elem('path',{d:`M -40 0 Q 0 -40 40 0`, fill:'none', stroke:stroke, 'stroke-dasharray':'3 8'});
      g.appendChild(spray);
      break;
    }
    case 'zen': {
      mainShape = elem('rect',{x:-meta.w/2,y:-meta.h/2,width:meta.w,height:meta.h, rx:18, ry:18, class:'shape'}); g.appendChild(mainShape);
      for(let i=-meta.h/2+14;i<meta.h/2-10;i+=16){
        g.appendChild(elem('path',{d:`M ${-meta.w/2+10} ${i} Q 0 ${i-6} ${meta.w/2-10} ${i}`, fill:'none', stroke:stroke, 'stroke-opacity':.6}));
      }
      for(let i=0;i<6;i++){





